<?xml version="1.0" encoding="utf-8"?>
<module xmlns="http://www.kinoma.com/kpr/1">

	<require path="PinsSimulators" id="PinsSimulators"/>

	<function id="configure" params="configuration"><![CDATA[
		this.pinsSimulator = shell.delegate("addSimulatorPart", {
			header : { 
				label : "TCS34725", 
				name : "I2C Color Sensor", 
				iconVariant : PinsSimulators.SENSOR_LED 
			},
			axes : [
				new PinsSimulators.FloatAxisDescription(
					{
						ioType : "input",
						dataType : "float",
						valueLabel : "Red",
						valueID : "r",
						minValue : 0,
						maxValue : 255,
						value : 255,
						speed : 0.33,
						defaultControl : PinsSimulators.SLIDER
					}
				),
				new PinsSimulators.FloatAxisDescription(
					{
						ioType : "input",
						dataType : "float",
						valueLabel : "Green",
						valueID : "g",
						minValue : 0,
						maxValue : 255,
						value : 255,
						speed : 0,
						defaultControl : PinsSimulators.SLIDER
					}
				),
				new PinsSimulators.FloatAxisDescription(
					{
						ioType : "input",
						dataType : "float",
						valueLabel : "Blue",
						valueID : "b",
						minValue : 0,
						maxValue : 255,
						value : 0,
						speed : 0,
						defaultControl : PinsSimulators.SLIDER
					}
				),
				new PinsSimulators.BooleanAxisDescription(
					{
						ioType : "output",
						dataType : "boolean",
						valueLabel : "LED",
						valueID : "led",
						minValue : 0,
						maxValue : 1,
						value : 0
					}
				),
			]
		});
	]]></function>

	<function id="close"><![CDATA[
		shell.delegate("removeSimulatorPart", this.pinsSimulator);
	]]></function>

	<function id="getColor"><![CDATA[
		return this.getValue();
	]]></function>

	<function id="getValue"><![CDATA[
		var result = this.pinsSimulator.delegate("getValue");		
		return { r : result.r, g : result.g, b : result.b };
	]]></function>

	<script><![CDATA[
		exports.pins = {
			rgb: { type: "I2C", address: 0x29, gain: 16, integrationTime: 153.6 },
			led: { type: "Digital", direction: "output", ledValue: 1 }
		};	
	]]></script>

</module>